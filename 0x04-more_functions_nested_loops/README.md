more functions and nested lops
